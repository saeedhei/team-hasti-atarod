### ðŸ“„ Security Advisory: CVE-2025-66478 â€” React Server Components RCE Vulnerability

**Overview**

On December 3rd, 2025, a critical vulnerability was disclosed that affects all Next.js applications using the App Router with React Server Components (RSC).

- CVSS Score: 10.0 (Critical)
- Impact: Remote Code Execution (RCE)
- Affected Next.js versions:
  - 15.x
  - 16.x
  - 14.3.0-canary.77 and later canaries

The issue stems from upstream React (CVE-2025-55182) and affects the downstream RSC protocol used by Next.js.

---

**Impact on Our Project**

Although our application was not deployed publicly, this vulnerability has been confirmed to be exploitable in real-world environments, which highlights the importance of upgrading to a patched version even for local development setups.

To ensure future safety and avoid carrying vulnerable dependencies, we upgraded the project immediately.

---

**Required Fix**
There is no workaround for this vulnerability.
Upgrading to a patched version is the only fix.

**âœ” Upgrade Next.js:**

```bash
pnpm add next@16.0.7
```

This version includes the fully hardened RSC implementation.

**âœ” Verify patch with the official scanner:**

```bash
npx fix-react2shell-next
```

---

**Secrets Rotation**

Secret rotation is required only if the vulnerable application was deployed online.

Because our app was never deployed, rotating secrets was not required for this project, but the advisory recommends rotating secrets for deployed systems.

**Secrets that typically require rotation:**

- `DATABASE_URL`
- CouchDB credentials
- JWT secrets
- API keys
- OAuth secrets
- Stripe keys
- Vercel tokens
- `AUTH_SECRET` (Auth.js / NextAuth)
- Any values stored in `.env*`

---

**Optional Tools**

#### 1. Interactive Dependency Upgrade Tool (for security fixes only)

The following tool checks Next.js, React, and RSC protocol versions and applies deterministic version bumps:

```bash
npx fix-react2shell-next

```

This tool is specific to this security advisory and does NOT modify your code.

---

#### 2. Codemod Upgrade Tool (General Purpose)

While **NOT** required for this CVE, Next.js provides a codemod command that can be useful when upgrading across major versions or adopting new APIs.

```bash
npx @next/codemod upgrade

```

This tool:

- modifies your project files
- updates imports, APIs, and patterns
- helps migrate older code to new Next.js conventions

[!IMPORTANT]
This command should NOT be used for the CVE fix because it performs source-code transformations.
It is mentioned here only as a reference for future migrations.
